<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>商品</title>
	</head>
	<body>
		<ul id="list">
			<li>
				<input type="button" value="-"/>
				<strong>0</strong>
				<input type="button" value="+" />
				单价：<em>12.5元</em>
				小计：<span>0元</span>
			</li>
			<li>
				<input type="button" value="-" />
				<strong>0</strong>
				<input type="button" value="+" />
				单价：<em>10.5元</em>
				小计：<span>0元</span>
			</li>
			<li>
				<input type="button" value="-" />
				<strong>0</strong>
				<input type="button" value="+" />
				单价：<em>8.5元</em>
				小计：<span>0元</span>
			</li>
			<li>
				<input type="button" value="-"/>
				<strong>0</strong>
				<input type="button" value="+" />
				单价：<em>18元</em>
				小计：<span>0元</span>
			</li>
			<li>
				<input type="button" value="-" />
				<strong>0</strong>
				<input type="button" value="+" />
				单价：<em>14.5元</em>
				小计；<span>0元</span>
			</li>
		</ul>
		<p>
			商品合计共：0件，共花费：0元<br />
			其中最贵商品单价：0元
		</p>
	</body>
	<script>
		window.onload=function(){
			var oUl=document.getElementById('list')
			var aLi=oUl.getElementsByTagName('li')
			var oP=document.getElementsByTagName('p')[0];
			var aPrice=[];
			var totalPrice=0;
			var totalcount=0;
			init();
			function init(){
				for(var i=0;i<aLi.length;i++){
					initItem(aLi[i]);
				}
				updateItems();
			}
			
			function updateItems(){
				totalCount=0;
				totalPrice=0;
				for(var i=0;i<aLi.length;i++){
					totalCount+=(parseInt(aLi[i].getElementsByTagName('strong')[0].innerHTML));
					totalPrice+=(parseFloat(aLi[i].getElementsByTagName('span')[0].innerHTML));
				}
				oP.innerHTML="商品合计共："+totalcount+"件，共花费了："+totalPrice+"<br/>其中最贵的商品单价是："+getmax(aPrice);
			}
			
			function initItem(oLi){
				var aBtn=oLi.getElementsByTagName('input');
				var oEm=oLi.getElementsByTagName('em')[0];
				var oSpan=oLi.getElementsByTagName('span')[0];
				var ostrong=oLi.getElementsByTagName('strong')[0];
				var count=oStrong.innerHTML*1;
				var price=parseFloat(oEm.innerHTML);
				aPrice.push(price);
				oSpan.innerHTML=count*price;
				
				aBtn[0].onclick=function(){showUp(false);}
				aBtn[1].onclick=function(){showUp(true);}
				function showUp(isAsc){
					isAsc?count++:((count--<=0)?count=0:count);
					oStong.innerHTML=count;
					oSpan.innerHTML=count*price+'元';
					updateItems();
				}
			}
			
		}
		function getMax(arr){
			var max=arr[0];
			for(var i=1;i<arr.length;i++){
				if(max<arr[i]){
					max=arr[i];
				}
			}
			return max;
		}
	</script>
</html>
